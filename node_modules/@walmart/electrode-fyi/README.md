# Electrode FYI

If I get a dollar every time a silent error cause an issue....

Most times, in case of an error, `console.log` is the only thing we can safely use to report it.  However, using `console.log` isn't ideal.  For example, you might not want that noise in tests.

This module is created for any module that wish to make a beep for unexpected errors but makes it possible to let users control the output with env variables.

# Usage

```js
const fyi = require("@walmart/electrode-fyi");

fyi.info("hello", "world");
fyi.warn("hello", "world");
fyi.error("hello", "world");
```

The output would look something like this:

    FYI info: hello world
    FYI warn: hello world
    FYI error: hello world

# Install

```bash
npm install --save @walmart/electrode-fyi
```

# The Logger

This module uses the `console` to log the messages.

-   `info` - `console.info`
-   `warn` - `console.warn`
-   `error` - `console.error`

# `assert`

A function `assert` is provided:

```js
fyi.assert(condition, message)
```

-   If condition is falsy, then an error with `message` is created and its stack is logged with `fyi.error`, and then thrown.
-   If message is a function, it will be called to get the actual string message.

# limit output

If you want to avoid dumping out to the logger through `fyi` endlessly, you can get a limitter that will
stop emitting to the logger once a limit is reached.

The APIs are:

-   `fyi.limitError(tag, limit)`
-   `fyi.limitWarn(tag, limit)`
-   `fyi.limitInfo(tag, limit)`

To use, call them with a tag that identifies the log and an integer for limit.

For example:

```js
const fyi = require("@wlamart/electrode-fyi");

const fyiError = fyi.limitError("foo tag", 50);

function foo() {
  fyiError("some error occurred")
}
```

This sample will output `some error occurred` 50 times and then one final log in the form of:

`foo tag: too many fyi errors, supressing all further errors.`

# Settings

Default output is `info` with color turned on.

You can control the log level by setting `global.ElectrodeFyiLevel`.  Accepted values are:

-   `info` - Logs all levels
-   `warn` - Only warn and errors
-   `error` - Only errors
-   `none` - Logs nothing

To turn off color, set `global.ElectrodeFyiColor` to `false`.

For example:

```js
const fyi = require("@walmart/electrode-fyi");

global.ElectrodeFyiLevel = "warn";
fyi.info("hello", "world"); // will not be logged
fyi.warn("hello", "world");
global.ElectrodeFyiColor = false;
fyi.error("hello", "world"); // will not be colorized
```

## environment variables

You can also control these two setting with environment variable before you require this module.

The env variables are only checked once when this module is loaded the first time by `require`.

After it's loaded, it will not check the environment variables anymore.

-   env `ELECTRODE_FYI_LEVEL` - set log level
-   env `ELECTRODE_FYI_COLOR` - set log color
