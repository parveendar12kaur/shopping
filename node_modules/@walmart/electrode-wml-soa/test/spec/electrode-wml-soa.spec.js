"use strict";

const WmlSoa = require("../..");
const fs = require("fs");
const wmHeaders = WmlSoa.wmHeaders;

describe("wml-soa", function () {
  const key = {
    "version": 1,
    pemKey: fs.readFileSync("test/data/private-key.pem").toString("ascii")
  };

  it("should sign headers with proper key", () => {
    const headers = {
      [wmHeaders.consumerId]: "test12345",
      [wmHeaders.consumerInTimestamp]: 123456789,
      [wmHeaders.secKeyVersion]: 2
    };
    WmlSoa.signEsbHeaders(headers, key);
    expect(headers[wmHeaders.secKeyVersion]).to.equal(1);
    expect(headers[wmHeaders.secAuthSig]).to.equal("HyGyEgyrQdBrfGMW4mLt5403wAPhJROUGuokbGscYcAqO5iuMIikljZDSqDK8icfbWOUlkPcSjQPblf4rI/+T3ou9aMNr7Thv50p1IgidSZroP3hqvYkXNbUUyf4nVn5cij2MOG38ZkVkyTMVeLgFAuKSdg04V5eDHFDoHayEuQ="); // eslint-disable-line
  });
});
