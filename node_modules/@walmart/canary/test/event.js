/* eslint-disable func-names */
var test = require('tape');
var createEvent = require('../lib/event');

test('event', function (t) {
    var event = createEvent();

    t.equal(typeof event, 'function', 'should be a function');
    t.ok(Array.isArray(event.history), 'should have history array property');

    t.end();
});

test('event.history', function (t) {
    var event = createEvent();

    t.equal(event.history.length, 0, 'should start empty');
    event.produce({ hello: 'world' });
    t.equal(event.history.length, 1, 'should be populated with produced events');
    for (var i = 0; i < 150; i++) {
        event.produce({ eventNum: i });
    }
    t.equal(event.history.length, 100, 'should be capped at 100 events');
    t.equal(event.history[0].eventNum, 149, 'should contain newest event at beginning');
    t.equal(event.history[99].eventNum, 50, 'should contain oldest event at end');

    t.end();
});

test('event.history size should be configurable', function (t) {
    var event = createEvent({ historySize: 10 });

    for (var i = 0; i < 150; i++) {
        event.produce({ eventNum: i });
    }
    t.equal(event.history.length, 10);

    t.end();
});
