/* eslint-disable func-names */
var test = require('tape');
var createCanary = require('..');

test('canary.event.getHistory returns event payloads', function (t) {
    t.plan(1);
    var now = Date.now();

    var canary = createCanary({ suspend: false });

    for (var i = 0; i < 3; i++) {
        canary.process({ test: i, timestamp: now });
    }

    t.deepEqual(canary.event.getHistory(), [
        { test: 2, timestamp: now },
        { test: 1, timestamp: now },
        { test: 0, timestamp: now }
    ]);
});

test('canary.event.getHistory accepts arg n', function (t) {
    t.plan(1);
    var now = Date.now();

    var canary = createCanary({ suspend: false });

    for (var i = 0; i < 3; i++) {
        canary.process({ test: i, timestamp: now });
    }

    t.deepEqual(canary.event.getHistory(2), [
        { test: 2, timestamp: now },
        { test: 1, timestamp: now }
    ]);
});
