"use strict";
// ES5 compatible to be usable in the browser
/* eslint-disable no-var, prefer-arrow-callback,  */
/**
 * This function parses exp cookie into a comma delimited string.
 *
 * What we do is to split on "|", then for each entry, split on ".",
 * then split on "~" and join those entries by comma (,)
 *
 * i.e. A sample value might be:
 * 1%2B1464981377%2BTOeFFxP3jXgwI5H9MvGNBo%2B0%2B2W_Ns.s3WcL|
 * 9w8Em.O4RKM|M-Jcg.KWWTw|QM7Tk.IgHI3~ueBuV~ahD9x|cuqya.G1flG
 *
 * The resulting comma delimited string should be:
 * s3WcL,O4RKM,KWWTw,IgHI3,ueBuV,ahD9x,G1flG
 *
 * https://gecgithub01.walmart.com/electrode-client/electrode-ccm-client/issues/6
 *
 * @param {string} exp - exp cookie string
 * @return {string} str - comma delimited string
 */
function parse(exp) {
  if (!exp) {
    return "";
  }

  var result = [];
  exp.split("|").forEach(function(entry) {
    var s = entry.split(".")[1];
    if (s) {
      result.push(s.split("~"));
    }
  });

  return result.join(",");
}

module.exports = {
  parse: parse
};
