// Load modules
var Lab = require("lab");
var Code = require("Code");
var lab = exports.lab = Lab.script();

var describe = lab.describe;
var it = lab.it;
var before = lab.before;
var after = lab.after;
var expect = Code.expect;

var Psych = require("..");

var AKAMAI_HEADER_NAME = "akamai-bot";

describe("is-akamai-bot", function () {
  it("should be a function", function (done) {
    expect(Psych.isAkamaiBot).to.be.a.function();
    done();
  });

  it("should return false when no headers supplied", function (done) {
  	var isBot = Psych.isAkamaiBot();

    expect(isBot).to.equal(false);
    done();
  });

  it("should return false for empty headers", function (done) {
    var isBot = Psych.isAkamaiBot({});

    expect(isBot).to.equal(false);
    done();
  });

  it("should return false for when akamai-bot header is not present", function (done) {
    var sampleAkamaiHeader = {};
    sampleAkamaiHeader["akamai-test-header"] = "abc"
    var isBot = Psych.isAkamaiBot(sampleAkamaiHeader);

    expect(isBot).to.equal(false);
    done();
  });

  it("should return true for when akamai-bot header value is present", function (done) {
    var sampleAkamaiHeader = {};
    sampleAkamaiHeader[AKAMAI_HEADER_NAME] = "anyvalue"
    var isBot = Psych.isAkamaiBot(sampleAkamaiHeader);

    expect(isBot).to.equal(true);
    done();
  });
});
