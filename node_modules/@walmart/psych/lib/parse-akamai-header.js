var AKAMAI_DEVICE_CHARACTERISTICS_REQUEST_HEADER_NAME = "x-akamai-device-characteristics";
var AKAMAI_IS_WIRELESS_DEVICE = "is_wireless_device";
var AKAMAI_IS_TABLET = "is_tablet";

// Parses Akamai X-Akamai-Device-Characteristics header and converts mobile/tablet type info to object
module.exports = function (header) {
  return header
      .split(";")
      .filter(tabletOrMobileFilter)
      .reduce(headerToObjectMap, {});
};


function tabletOrMobileFilter (value) {
  return value.indexOf(AKAMAI_IS_TABLET) != -1 || value.indexOf(AKAMAI_IS_WIRELESS_DEVICE) != -1;
};


function headerToObjectMap (prev, curr, index, array) {
	var headerArray = curr.split("=");
  var key = headerArray[0].trim();
  var value = headerArray[1];
  prev[key] = value;

  return prev;
};
