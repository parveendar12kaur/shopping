"use strict";

const makeConfig = require("../../lib/make-config");

describe("makeConfig", function () {
  it("should load oneops env profile config", () => {
    const res = {
      "json": "json",
      "oneops": "prod",
      "deployment": "production",
      "oneops-default": "true"
    };
    process.env.ONEOPS_ENVPROFILE = "prod";
    process.env.ONEOPS_ENVIRONMENT = "prod4";
    process.env.NODE_ENV = "production";
    process.env.NODE_CONFIG_DIR = "test/config";
    const data = makeConfig();

    expect(data).to.deep.equal(res);
  });

  it("should not load default dev oneops env profile", () => {
    const res = {
      "json": "json",
      "oneops": "",
      "deployment": "development"
    };

    delete process.env.ONEOPS_ENVPROFILE;
    delete process.env.ONEOPS_ENVIRONMENT;
    process.env.NODE_ENV = "development";
    process.env.NODE_CONFIG_DIR = "test/config";
    const data = makeConfig();

    expect(data).to.deep.equal(res);
  });

});
