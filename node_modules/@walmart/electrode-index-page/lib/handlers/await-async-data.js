"use strict";

const fyi = require("@walmart/electrode-fyi");
const Promise = require("bluebird");

module.exports = function(context) {
  const data = this.props.data;
  const request = context.user.request;

  if (!data || data.length < 1) {
    fyi.error(`${this.id} - no data specified to await.`);
    return Promise.resolve("");
  }

  return Promise.each(data, x => {
    if (x === "ccm") return request.app.ccmReady;
    else if (x === "seo") return request.app.seoAsync;
    else fyi.error(`${this.id} - unknown data tag`, x);
    return undefined;
  }).then(() => "");
};
