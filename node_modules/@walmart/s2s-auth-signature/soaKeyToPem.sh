#!/usr/bin/env bash
function usage() {
  cat <<EOF
usage: $0 <output-key-file>.pem
EOF
  exit 1
}

[ -n "$1" ] || usage

function fail() {
	echo $1
	exit 1
}

echo "Please paste your SOA key, press enter and then ctrl+D"

TMPFILE=/tmp/$$.output.pem

KEY=`cat | fold -w64`

cat > $TMPFILE << EOF
-----BEGIN PRIVATE KEY-----
$KEY
-----END PRIVATE KEY-----
EOF

RES=$(openssl rsa -in $TMPFILE -check -noout)
[ "$RES" == "RSA key ok" ] || fail "key bad"

openssl rsa -in $TMPFILE -out $1
