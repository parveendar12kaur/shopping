"use strict";

const crypto = require("crypto");

function generateS2SAuthSignature(headers, privateKey, signList) {
  const wmHeaders = signList.sort();
  const signedParametersList = `${wmHeaders.join(";")};`;
  const wmValStr = `${wmHeaders.map((x) => headers[x]).join("\n")}\n`;

  const rsaSigner = crypto.createSign("RSA-SHA256");
  rsaSigner.update(wmValStr);
  const signatureVal = rsaSigner.sign(privateKey, "base64");

  return {
    signedParametersList,
    signatureVal
  };
}

module.exports = {
  generateS2SAuthSignature
};
